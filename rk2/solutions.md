# РК2  
## Вариант 27   
## Задача 1
*Язык всех слов, порождаемых грамматикой* $S \to bSSb, S \to aSa, S \to \varepsilon$ *из  
начального нетерминала S, таких, что они не являются палиндромами.*  

### Анализ КС-свойства
По отдельности правила языка порождают палиндромы. Непалиндромы в языке появляются в тот момент,  
когда после применения правила $S \to bSSb$ начало левого $S$ и конец правого $S$ не совпадают.  
Это достигается, когда левый и правый $S$ переписываются по разным правилам:  
$S \to baSabSSbb$ или $S \to bbSSbaSab$.  
Таким образом, можно получить такую грамматику, учитывающую как исходную грамматику,  
так и непалиндромность:  
$S \to aSa$  
$S \to bSSb$  
$S \to baTabTTbb$  
$S \to bbTTbaTab$  
$T \to aTa$  
$T \to bTTb$  
$T \to \varepsilon$  
Поэтому данный язык КС.

### Анализ регурности  
Язык нерегулярный, можно построить бесконечную таблицу классов эквивалентности:  
|   | $aab$ | $a^4b$ | $a^6b$  | ... |
|---|---|---|---|---|
| $baabb$  | −  | + | + | + |
| $ba^4bb$  | +  |  − | +  | + |
|  $ba^6bb$ | +  | +  | −  | +  |
|  ...  | + | +  | +  | −  |

  

---
## Задача 2
### Условие

Язык
```math
L = \left\{
\, w_1 a w_2 w_3 \;\middle|\;
|w_1| > 0 \;\land\;
\bigl( w_1 = w_2^{R} \;\lor\; w_1 = w_3^{R} \bigr)
\right\}.
```
### Решение  
Рассмотрим дополнение этого языка $\overline{L}$, пересеченное с регулярным выражением $R$ = $cb^+cacb^+cb^+c$.  
Получившийся язык $L'$ = $\overline{L} ∩ R$.  
Рассмотрим слово $w = cb^pcacb^{p+p!}cb^{p+p!}c ∈ L'$, где `p` - константа из леммы Огдена.  
Предположим, что язык $L'$ - КС, тогда выполняется лемма Огдена.  
Пусть $L' = uvxyz$, пометим первый блок $b^p$.  
Рассмотрим возможные случаи расположения u, v, x, y, z:  
1) `y` и `z` оба содержат выделенные позиции.
   То есть $y = b^t$, где `0<t<p`.  
   1.1) `v` содержит первую `c` - при нулевой накачке, очевидно, слово перестанет принадлежать `R`.  
   1.2) `v` не содержит первую `c`, тогда $v = b^s$, где `0<s<p`.
   В таком случае при $i = p!/(t+s) + 1$ $uv^ixy^iz ∉ L'$, так как $w_1 = w_2^R = w_3^R$.
2) `u` и `v` оба содержат выделенные позиции.  
   То есть $v = b^s$, где `0<s<p`.  
   2.1) `y` содержит только `b` из $b^p$ - случай аналогичен 1.2.  
   2.2) `y` содержит `c` или `a` - при нулевой накачке, очевидно слово выйдет из `R`.  
   2.3) `y` целиком лежит в первом блоке $b^{p+p!}$. Этот блок будет качаться синхронно с `v`, но второй блок $b^{p+p!}$
   будет неизменным, поэтому при $i = p!/s + 1$ $w_1 = w_3^R$, а значит слово $uv^ixy^iz ∉ L'$  
   2.4) `y` целиком во втором блоке $b^{p+p!}$ - случай аналогичен 2.3  
   2.5) `y` затрагивает оба блока $b^{p+p!}$ - тогда `y` неизбежно затронет `c` между этими блоками - слово выйдет из `R` при нулевой накачке.  
   2.6) `y` затрагивает последнюю `c` - случай аналогичен 2.2.  
Таким образом, для слова `w` лемма Огдена неверна, а значит язык `L'` не является КС, а следовательно и детерминированным.  
Так как детерминированные языки замкнуты относительно дополнения и пересечения с регулярными языками, то исходный язык `L` соответственно так же не является DCFL.
---
## Задача 3
### Условие
```math
\begin{alignedat}{1}
S &\to SbS \;;\quad S_2.attr \ge S_1.attr,\; S_0.attr := S_1.attr \cdot S_2.attr \\
S &\to cA \;;\quad S.attr := A.attr \\
A &\to aA \;;\quad A_0.attr := A_1.attr + 1 \\
A &\to \varepsilon \;;\quad A.attr := 0
\end{alignedat}
```
### Решение
Как можно заметить, язык состоит из одного или нескольких блоков вида $ca^{n_i}$, разделенных между собой `b`,  
причем существует некоторый способ расставить скобки между блоками (сопоставить слову дерево разбора по правилу $S \to SbS$), что на каждом шаге разбиения произведение чисел $n_i$ в правой части не меньше произведения чисел $n_i$ в левой части, т.е. если в дереве разбора последовательность  
$(n_l, ..., n_r)$ разбивается на $(n_l, ..., n_t)$ и $(n_{t+1}, ..., n_r)$, то должно выполняться:  
```math
\prod_{i=t+1}^{r} n_i \;\ge\; \prod_{i=\ell}^{t} n_i
```
Предположим что данный язык КС, тогда выполняется лемма о накачке для КС языков.  
Рассмотрим пересечение исходного языка с $R = ca^+bca^+bca^+$  
Рассмотрим слово $w = ca^{n^2}bca^nbca^n$, где `n` - постоянная накачки. Обозначим первый блок за $w_1$, второй - $w_2$, третий - $w_3$.  
То есть $w = w_1bw_2bw_3$.  
Проверим, что `w` лежит в `L ∩ R`:  
* w соответсвует регулярному выражению, приведенному выше;  
* при расстановке скобок: $w_1b(w_2bw_3)$ условия $n_3 \ge n_2$ и $n_3 \cdot n_2 \ge n_1$ выполняются,  
  так как $n \ge n$ - верно, $n \cdot n \ge n^2$ - верно.  
Пусть $w = uvxyz$. Рассмотрим все возможные наложения `vxy` на слово:  
1) Если накачиваемая часть затрагивает `b` или `c`, то слово выходит из `R` при  
   нулевой накачке.  
2) Если `vxy` лежит целиком в $a^{n^2}$ в $w_1$, то при положительной накачке слово станет  
   $ca^{n^2+t}bca^nbca^n$, `t>0`. Рассмотрим возможные расстановки скобок:  
   2.1) $w_1b(w_2bw_3)$ - в таком случае условие $n_3 \cdot n_2 \ge n_1$ нарушится,  
   так как $n \cdot n \ge n^2 + t$ - неверно  
   2.2) $(w_1bw_2)bw_3$ - нарушается условие $n_2 \ge n_1$, так как $n \ge n^2 + t$ - неверно.  
3) Если `vxy` лежит целиком в $a^n$ в $w_2$, то при положительной накачке слово станет  
   $ca^{n^2}bca^{n+t}bca^n$, `t>0`. Рассмотрим расстановки скобок:  
   3.1) $w_1b(w_2bw_3)$ - в таком случае условие $n_3 \ge n_2$ нарушается, так как  
   $n \ge n+t$ - неверно  
   3.2) $(w_1bw_2)bw_3$ - в этом случае нарушится условие $n_3 \ge n_2 \cdot n_1$, так как  
   $n \ge n^2 \cdot (n+t)$ - неверно.
4) Если `vxy` лежит целиком в $a^n$ в $w_3$, то при нулевой накачке слово станет:  
   $ca^{n^2}bca^nbca^{n-t}$, `t>0`. Рассмотрим расстановки скобок:  
   4.1) $w_1b(w_2bw_3)$ - в таком случае условие $n_3 \ge n_2$ нарушается, так как  
   $n-t \ge n$ - неверно.  
   4.2) $(w_1bw_2)bw_3$ - нарушается $n_3 \cdot n_2 \ge n_1$, так как $n-t \ge n \cdot n^2$ - неверно.  
5) Если `vxy` лежит одновременно в $a^{n^2}$ в $w_1$ и $a^n$ в $w_2$ (при этом `v` и `y`  
   не затрагивают `bc`). В таком случае после положительной накачки слово станет:  
   $ca^{n^2+t}bca^{n+s}bca^n$. Рассмотрим расстановки скобок:  
   5.1) $w_1b(w_2bw_3)$ - нарушается $n_3 \ge n_2$, так как $n \ge n+s$ - неверно.  
   5.2) $(w_1bw_2)bw_3$ - нарушается $n_3 \ge n_2 \cdot n_1$, так как $n \ge (n+s) \cdot (n^2+t)$ - неверно.  
6) Если `vxy` лежит одновременно в $a^n$ в $w_2$ и в $a^n$ в $w_3$  
   (при этом `v` и `y`  не затрагивают `bc`).  
   В таком случае после нулевой накачки слово станет:  
   $ca^{n^2}bca^{n-t}bca^{n-s}$. Рассмотрим расстановки скобок:  
   6.1) $w_1b(w_2bw_3)$ - нарушается $n_3 \cdot n_2 \ge n_1$, так как $(n-s) \cdot (n-t) \ge n^2$ - неверно.  
   6.2) $(w_1bw_2)bw_3$ - нарушается $n_2 \ge n_1$, так как $n-t \ge n^2$ - неверно.  
Таким образом, лемма о накачке КС языков неверна, а значит пересечение с `R` не является КС языком.  
КС языки замкнуты относительно операции пересечения с `R`, поэтому `L` - не КС язык.
